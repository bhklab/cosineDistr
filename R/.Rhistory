theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + ylab("Features") + xlab("") +
guides(fill="none")
dev.off()
a1 <- reshape2::melt(t(ds@mat[1:50,1]))
a2 <- reshape2::melt(t(ds@mat[1:50,2]))
adiff <- reshape2::melt(t(ds@mat[1:50,2] - ds@mat[1:50,1]))
pdf(file.path(scratchdir, "perturbVectors.pdf"), width=0.8, height=5)
ggplot(a1, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="blue", mid="white", high="red") + theme_minimal() +
theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + ylab("Features") + xlab("") +
guides(fill="none")
ggplot(a2, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="blue", mid="white", high="red") + theme_minimal() +
theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + ylab("Features") + xlab("") +
guides(fill="none")
ggplot(adiff, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="blue", mid="white", high="red") + theme_minimal() +
theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + ylab("Features") + xlab("") +
guides(fill="none")
dev.off()
a <- reshape2::melt(t(ds@mat[1:50,1:2]))
a
head(a)
a <- reshape2::melt(t(ds@mat[1:50,1:3]))
a <- reshape2::melt(t(ds@mat[1:30,1:3]))
pdf(file.path(scratchdir, "perturbVectors.pdf"), width=0.8, height=5)
ggplot(a, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="blue", mid="white", high="red") + theme_minimal() +
theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + ylab("Features") + xlab("") +
guides(fill="none")
dev.off()
pdf(file.path(scratchdir, "perturbVectors.pdf"), width=1.5, height=5)
ggplot(a, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="blue", mid="white", high="red") + theme_minimal() +
theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + ylab("Features") + xlab("") +
guides(fill="none")
dev.off()
dim(a)
a
1:10:2
1:2:10
a[seq(1,88,3),3]
a[seq(2, 89, 3), 3] - a[seq(1,88,3),3]
a[seq(3, 90, 3), 3] <- a[seq(2, 89, 3), 3] - a[seq(1,88,3),3]
pdf(file.path(scratchdir, "perturbVectors.pdf"), width=1.5, height=5)
ggplot(a, aes(x=Var1, y=Var2, fill=value)) + geom_tile() + scale_fill_gradient2(low="blue", mid="white", high="red") + theme_minimal() +
theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + ylab("Features") + xlab("") +
guides(fill="none")
dev.off()
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7))
xn1 <- mvrnorm(n=1e4, mu=c(2,1), Sigma=matrix(c(2, -1, -1, 2), nrow=2))
xn2 <- mvrnorm(n=1e4, mu=c(2,1), Sigma=matrix(c(0.4, -0.2, -0.2, 0.4), nrow=2))
colnames(xn1) <- c("x1", "x2")
colnames(xn2) <- c("x1", "x2")
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7))
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d() + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7))
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7))
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7)) + theme(axis.ticks.x=element_bank() + axis.ticks.y=element_blank()) + xlab("") + ylab("")
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7)) + theme(axis.ticks.x=element_bank(), axis.ticks.y=element_blank()) + xlab("") + ylab("")
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7)) + theme(axis.ticks.x=element_blank(), axis.ticks.y=element_blank()) + xlab("") + ylab("")
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7)) + theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank()) + xlab("") + ylab("")
ggplot(as.data.frame(xn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) + xlim(c(-3, 7)) +
ylim(c(-5, 7)) + theme(axis.text.x=element_blank(), axis.ticks.x=element_blank(),
axis.text.y=element_blank(), axis.ticks.y=element_blank(),
panel.grid.major=element_blank(), panel.grid.minor=element_blank()) + xlab("") + ylab("")
xn0 <- mvrnorm(n=1e4, mu=c(0,0), Sigma=matrix(c(1, 0, 0, 1), nrow=2))
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
xn0 <- mvrnorm(n=1e4, mu=c(0,0), Sigma=matrix(c(1, 0, 0, 1), nrow=2))
head(xn0)
xn0 <- mvrnorm(n=1e4, mu=c(0,0), Sigma=matrix(c(1, 0, 0, 1), nrow=2))
colnames(xn0) <- c("x1", "x2")
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
xn0 <- mvrnorm(n=1e5, mu=c(0,0), Sigma=matrix(c(1, 0, 0, 1), nrow=2))
colnames(xn0) <- c("x1", "x2")
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.002) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01) + geom_point() + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d() + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(aes(fill=level)) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(aes(fill=level)) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(aes(fill=..level..)) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(aes(fill=after_stat(level))) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
?geom_density_2d
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d_filled() + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(geom+"polygon") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(aes(geom+"polygon")) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(aes(geom="polygon")) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(geom="polygon") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.005, linewidth=2) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1, geom="polygon") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + stat_density_2d(binwidth=0.01, linewidth=1, geom="polygon") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5)
ggplot(as.data.frame(xn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-4, 4)) + ylim(c(-4,4))
exn0 <- mvrnorm(n=1e5, mu=c(0,0), Sigma=matrix(c(1, 0, 0, 1), nrow=2))
exn1 <- mvrnorm(n=1e5, mu=c(0,0), Sigma=matrix(c(-2, 1, 1, -2), nrow=2))
exn1 <- mvrnorm(n=1e5, mu=c(0,0), Sigma=matrix(c(2, 1, 1, 2), nrow=2))
exn2 <- mvrnorm(n=1e5, mu=c(3,-1), Sigma=matrix(c(2, -1, -1, 2), nrow=2))
colnames(exn0) <- c("x1", "x2")
colnames(exn1) <- c("x1", "x2")
colnames(exn2) <- c("x1", "x2")
ggplot(as.data.frame(exn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-4, 4)) + ylim(c(-4,4))
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-4, 4)) + ylim(c(-4,4))
exn1 <- mvrnorm(n=1e5, mu=c(0,0), Sigma=matrix(c(3, 1, 1, 3), nrow=2))
exn2 <- mvrnorm(n=1e5, mu=c(3,-1), Sigma=matrix(c(3, -1, -1, 3), nrow=2))
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-4, 4)) + ylim(c(-4,4))
colnames(exn0) <- c("x1", "x2")
colnames(exn1) <- c("x1", "x2")
colnames(exn2) <- c("x1", "x2")
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-4, 4)) + ylim(c(-4,4))
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
exn1 <- mvrnorm(n=1e5, mu=c(0,0), Sigma=matrix(c(2, 1.5, 1.5, 2), nrow=2))
exn2 <- mvrnorm(n=1e5, mu=c(3,-1), Sigma=matrix(c(2, -1.5, -1.5, 2), nrow=2))
colnames(exn0) <- c("x1", "x2")
colnames(exn1) <- c("x1", "x2")
colnames(exn2) <- c("x1", "x2")
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
exn2 <- mvrnorm(n=1e5, mu=c(-1,-3), Sigma=matrix(c(2, -1.5, -1.5, 2), nrow=2))
colnames(exn0) <- c("x1", "x2")
colnames(exn1) <- c("x1", "x2")
colnames(exn2) <- c("x1", "x2")
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
exn2 <- mvrnorm(n=1e5, mu=c(-1,-3), Sigma=matrix(c(2, -1.5, -1.5, 2), nrow=2))
head(exn2)
exn2[,2] <- exn2[,2] + 0.05*exn2[,2]^2 + 0.02*exn2[,1]^2
colnames(exn2) <- c("x1", "x2")
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
exn2 <- mvrnorm(n=1e5, mu=c(-1,-3), Sigma=matrix(c(2, -1.5, -1.5, 2), nrow=2))
exn2[,2] <- exn2[,2] + 0.04*exn2[,1]^2
colnames(exn0) <- c("x1", "x2")
colnames(exn1) <- c("x1", "x2")
colnames(exn2) <- c("x1", "x2")
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
exn2[,2] <- exn2[,2] + 0.1*exn2[,1]^2
colnames(exn0) <- c("x1", "x2")
colnames(exn1) <- c("x1", "x2")
colnames(exn2) <- c("x1", "x2")
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
pdf(file=file.path(scratchdir, "cosineTheoryDataDistributions.pdf", width=6, height=6))
pdf(file=file.path(scratchdir, "cosineTheoryDataDistributions.pdf"), width=6, height=6)
ggplot(as.data.frame(exn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
dev.off()
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1, color="forestgreen") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1, color="red") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
df(file=file.path(scratchdir, "cosineTheoryDataDistributions.pdf"), width=6, height=6)
pdf(file=file.path(scratchdir, "cosineTheoryDataDistributions.pdf"), width=6, height=6)
ggplot(as.data.frame(exn0), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1) + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-3, 3)) + ylim(c(-3,3))
ggplot(as.data.frame(exn1), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1, color="red") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
ggplot(as.data.frame(exn2), aes(x=x1, y=x2)) + geom_density_2d(binwidth=0.01, linewidth=1, color="forestgreen") + theme_minimal() +
geom_hline(yintercept = 0, color="black", lty=5) + geom_vline(xintercept = 0, color="black", lty=5) +
xlim(c(-6, 6)) + ylim(c(-6,6))
dev.off()
getwd()
list.files()
file.edit("fig5_Others.R")
source("paperscripts/figinit.R")
getwd()
setwd("..")
source("paperscripts/figinit.R")
library(DescTools)
eigendata <- readRDS(file.path(outdir, "../figspaper_res", "eigenvaluedata.rds"))
names(eigendata)
eigenBray <- readRDS(file.path(outdir, "../figspaper_res", "eigendataBray.rds"))
names(eigenBray)
names(eigenBray$pcBrayBase)
eigenBray$pcBrayBase$sdev[1:100]
eigenBray$pctvarBaseBray[1:20]
?prcomp
length(eigenBray$pcBrayBase$sdev)
outdir
eigendf <- data.frame(cellid=character(), dataset=character(), x=numeric(), cumpctvar=numeric())
for (ii in seq_along(eigendata)){
eigendf <- rbind(eigendf, data.frame(cellid=names(eigendata)[ii], x=seq(978), dataset="base", cumpctvar=cumsum(eigendata[[ii]]$pctvarBase)))
eigendf <- rbind(eigendf, data.frame(cellid=names(eigendata)[ii], x=seq(978), dataset="ML", cumpctvar=cumsum(eigendata[[ii]]$pctvarML)))
}
eigenBraydf <- rbind(data.frame(dataset="base", pctVar=pctvarBaseBray, cumVar=cumsum(pctvarBaseBray), index=seq_along(pctvarBaseBray)),
data.frame(dataset="ML", pctVar=pctvarMLBray, cumVar=cumsum(pctvarMLBray), index=seq_along(pctvarMLBray)))
attach(eigenBray)
eigenBraydf <- rbind(data.frame(dataset="base", pctVar=pctvarBaseBray, cumVar=cumsum(pctvarBaseBray), index=seq_along(pctvarBaseBray)),
data.frame(dataset="ML", pctVar=pctvarMLBray, cumVar=cumsum(pctvarMLBray), index=seq_along(pctvarMLBray)))
head(eigenBraydf)
dim(eigenBraydf)
dim(eigendf)
head(eigendf)
combdf
combdf <- eigendf
eigenbraydf2 <- eigenBraydf
eigenbraydf2$cellid <- "CDRP"
head(eigenbraydf2)
colnames(eigenbraydf2) <- c("dataset", "pctVar", "cumpctvar", "x", "cellid")
combdf <- rbind(combdf, eigenbraydf2[, c(5, 4, 1, 3)])
head(combdf)
ggplot(combdf[combdf$dataset == "base",], aes(x=x, y=cumpctvar, color=cellid)) + geom_line(lwd=1)
ggplot(combdf[combdf$dataset == "base",], aes(x=x, y=cumpctvar, color=cellid)) + geom_line(lwd=1) + theme_minimal() + coord_cartesian(xlim=c(0, 500)) + xlab("Eigenvalue index") + ylab("Cumulative percent variance") + ggtitle("Perturbational dataset eigenvalue CDF")
ggplot(combdf[combdf$dataset == "base",], aes(x=x, y=cumpctvar, color=cellid)) + geom_line(lwd=1) + theme_minimal() + coord_cartesian(xlim=c(0, 500)) + xlab("Eigenvalue index") + ylab("Cumulative percent variance") + ggtitle("Perturbational dataset eigenvalue CDF") + guides(color=guide_legend(title="Dataset"))
ggplot(combdf[combdf$dataset == "base",], aes(x=x, y=cumpctvar, color=cellid)) + geom_line(lwd=1) + theme_minimal() + coord_cartesian(xlim=c(0, 800)) + xlab("Eigenvalue index") + ylab("Cumulative percent variance") + ggtitle("Perturbational dataset eigenvalue CDF") + guides(color=guide_legend(title="Dataset"))
outdir
pdf(file.path(outdir, "deprecated", "baseEigenvalueDistributionPerturb.pdf"), width=8, height=6)
ggplot(combdf[combdf$dataset == "base",], aes(x=x, y=cumpctvar, color=cellid)) + geom_line(lwd=1) + theme_minimal() + coord_cartesian(xlim=c(0, 800)) + xlab("Eigenvalue index") + ylab("Cumulative percent variance") + ggtitle("Perturbational dataset eigenvalue CDF") + guides(color=guide_legend(title="Dataset"))
dev.off()
names(combds)
names(combds)
names(combData)
names(combData)
dim(combData)
combData[1:10,1:10]
min(combData)
max(combData)
median(combData[,1])
head(combMeta)
pertcounts <- table(combMeta$Metadata_pert_id)
length(pertcounts)
sort(pertcounts, decreasing=TRUE)
hist(pertcounts)
head(combMeta)
hist(combMeta$Metadata_pert_type)
table(combMeta$Metadata_pert_type)
combds[1:10,1:30]
table(combMeta$Metadata_pert_type)
head(combMeta)
hist(combMeta$Metadata_mmoles_per_liter)
sum(combMeta$Metadata_mmoles_per_liter > 10)
pertcounts <- table(combMeta$Metadata_pert_id)
sort(pertcounts, decreasing=TRUE)[1:100]
hist(pertcounts)
combMeta[combMeta$pert_id == "BRD-A00327403", ]
combMeta[combMeta$Metadata_pert_id == "BRD-A00327403", ]
which(combMeta$Metadata_pert_id == "BRD-A00327403")
combMeta[which(combMeta$Metadata_pert_id == "BRD-A00327403"),]
plot(totaldf$obsMean, log10(totaldf$theoryVar/totaldf$obsVar))
plot(totaldf$obsMean, log10(totaldf$theoryVar/totaldf$obsVar), xlab="Mean of Cosine similarity", ylab="Log10 theory var/obs var")
plot(totaldf$obsMean, log10(totaldf$theoryVar/totaldf$obsVar))
plot(totaldf$obsMean, totaldf$theoryMean)
head(totaldf)
plot(totaldf$varRatio, 1/(1-obsMean^2))
plot(totaldf$varRatio, 1/(1-totaldf$obsMean^2))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 0.5/(1-totaldf$obsMean^2))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 2/(1-totaldf$obsMean^2))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$obsMean, 1/totaldf$varRatio)
cor(totaldf$obsMean, 1/totaldf$varRatio)
plot(1/(1-totaldf$obsMean), totaldf$varRatio)
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$obsVar, totaldf$theoryVar)
lines(c(0,50), c(0,50), col="red", lty=2)
plot(-log10(totaldf$obsVar), -log10(totaldf$theoryVar))
plot(-log10(totaldf$obsVar), -log10(totaldf$theoryVar), xlim=c(0,6), ylim=c(0,6))
lines(c(0,50), c(0,50), col="red", lty=2)
getwd()
setwd("../synthLethal/")
list.files()
setwd("R")
list.files()
file.edit("createNetwork.R")
getwd()
file.edit("../../metriclearning/experimentFunctions.R")
file.edit("../../metasignatures/R/getMoments.R)
file.edit("../../metasignatures/R/getMoments.R")
?cor
wilcoxon
??wilcoxon
?pairwise.wilcox.test
?wilcox.test
?PharmacoGx::`summarizeMolecularProfiles,PharmacoSet-method`
PharmacoGx::`summarizeMolecularProfiles
,PharmacoSet-method
summarizeMolecularProfiles
library(PharmacoGx)
summarizeMolecularProfiles
PharmacoGx::summarizeMolecularProfiles
getwd()
list.files()
getwd()
list.files()
file.edit("createEssentialNetwork.R")
getwd()
file.edit("pmodel_apply.R")
library(caret)
getwd()
setwd("..")
usethis::use_package("caret")
usethis::use_package("stats")
usethis::use_package("PharmacoGx")
?roc
?caret::predict
?predict
??predict
getwd()
list.files()
setwd("R")
list.files()
usethis::use_package("pROC")
list.files()
file.edit("pmodelApply.R")
usethis::use_mit_license()
deppath <- "~/Work/bhk/data/depmap"
list.files(deppath)
ess <- read.csv(file.path(deppath, "CRISPR_gene_effect.csv"))
object.size(ess)
object.size(ess)/1e6
dim(ess)
ess[1:5,1:5]
expr <- read.csv(file.path(deppath, "CCLE_expression.csv"))
dim(expr)
expr[1:5,1:5]
length(intersect(colnames(expr), colnames(ess)))
length(intersect(rownames(ess), rownames(expr)))
essential <- ess
essential <- essential[intersect(rownames(essential, expr)), intersect(colnames(essential, expr))]
essential <- essential[intersect(rownames(essential), rownames(expr)),
intersect(colnames(essential), colnames(expr))]
expr <- expr[intersect(rownames(essential), rownames(expr)),
intersect(colnames(essential), colnames(expr))]
essential[1:10,1:10]
expr[1:10,1:10]
dim(expr)
dim(essential)
ess <- read.csv(file.path(deppath, "CRISPR_gene_effect.csv"), row.names = 1)
ess[1:5,1:%]
ess[1:5,1:5]
expr <- read.csv(file.path(datapath, "CCLE_expression.csv"), row.names=1)
expr <- read.csv(file.path(deppath, "CCLE_expression.csv"), row.names=1)
getwd()
file.edit("../../metasignatures/R/metasignatures.R")
library(metasignatures)
?getMetasigs
dim(expr)
dim(ess)
dim(essential)
ess[1:10,1:10]
essential <- ess
dim(essential)
essential[1:10,1:10]
expr[1:10,1:10]
essential <- essential[intersect(rownames(essential), rownames(expr)),
intersect(colnames(essential), colnames(expr))]
expr <- expr[intersect(rownames(essential), rownames(expr)),
intersect(colnames(essential), colnames(expr))]
essential[1:10,1:10]
expr[1:10,1:10]
dim(expr)
dim(essential)
essential <- ess
expr <- read.csv(file.path(deppath, "CCLE_expression.csv"), row.names=1)
plot(totaldf$varRatio, 2/(1-totaldf$obsMean^2))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 1/(1-totaldf$obsMean^2))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 1/(1-totaldf$obsMean^2), xlim=c(0,10), ylim=c(0,10))
plot(totaldf$varRatio, 2/(1-totaldf$obsMean^2), xlim=c(0,10), ylim=c(0,10))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 2.5/(1-totaldf$obsMean^2), xlim=c(0,10), ylim=c(0,10))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 2.5/(1-totaldf$obsMean^2)-1.5, xlim=c(0,10), ylim=c(0,10))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 1/(1-totaldf$obsMean))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$varRatio, 1/(1-totaldf$obsMean), xlim=c(0, 20), ylim=c(0,20))
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$obsMean, 1/totaldf$varRatio)
plot(totaldf$obsMean, 1-1/totaldf$varRatio)
plot(totaldf$obsMean, 1-1/totaldf$varRatio^2)
plot(totaldf$obsMean, 1-1/totaldf$varRatio)
lines(c(0,50), c(0,50), col="red", lty=2)
plot(totaldf$obsMean, 1/(1-totaldf$varRatio))
plot(totaldf$obsMean, 1/(1-totaldf$varRatio), xlim=c(0,1), ylim=c(0,1))
getwd()
ggplot(combdf[combdf$dataset == "base",], aes(x=x, y=cumpctvar, color=cellid)) + geom_line(lwd=1) + theme_minimal() + coord_cartesian(xlim=c(0, 800)) + xlab("Eigenvalue index") + ylab("Cumulative percent variance") + ggtitle("Perturbational dataset eigenvalue CDF") + guides(color=guide_legend(title="Dataset"))
plot(totaldf$obsVar, totaldf$theoryVar)
plot(-log10(totaldf$obsVar), -log10(totaldf$theoryVar))
plot(totaldf$obsVar, totaldf$theoryVar)
ggplot(totaldf, aes(x=obsVar, y=theoryVar, color=
head(totaldf)
ggplot(totaldf, aes(x=obsVar, y=theoryVar, color=ndim)) + geom_point()
head(combMeta)
table(combMeta$Metadata_pert_type)
table(combMeta$Metadata_solvent)
table(combMeta$Metadata_pert_vehicle)
table(combMeta$Metadata_pert_id[combMeta$Metadata_pert_type == "control"])
table(combMeta$Metadata_pert_mfc_id[combMeta$Metadata_pert_type == "control"])
table(combMeta$Metadata_pert_mfc_id[combMeta$Metadata_pert_type == "trt"])
head(combMeta)
getwd()
setwd("../../cosineDistr/")
list.files()
setwd("R")
list.files()
file.edit("cosineDistSpherical.R")
?cosineVsDim
?cor
?cosineVsDim
?stringr::str_unique
stats::var()
?stats::var()
stats::var(rnorm(1000, 0, 1))
?perturbKit::cosine
getwd()
file.edit("cosine.R")
3^2
3**2
source("~/Work/code/cosineDistr/R/cosine.R", echo=TRUE)
cosineApprox
a <- matrix(rnorm(1e5, 0,1), nrows=100)
a <- matrix(rnorm(1e5, 0,1), nrow=100)
dim(a)
acos
mycos
mycos <- cosine(a,a)
hist(mycos)
sd(mycos[upper.tri(mycos)])
mycosApprox <- cosineApprox(a,a, rep(0,100), rep(1,100))
hist(mycosApprox)
max(mycosApprox)
sd(mycosApprox[upper.tri(mycosApprox)])
plot(mycos, mycosApprox)
ggplot(data.frame(cos=mycos[upper.tri(mycos)], cosApprox=mycosApprox[upper.tri(mycosApprox)]), aes(x=cos, y=cosApprox)) + geom_density2d()
mycos <- mycos[1:100,1:100]
mycosApprox <- mycosApprox[1:100,1:100]
ggplot(data.frame(cos=mycos[upper.tri(mycos)], cosApprox=mycosApprox[upper.tri(mycosApprox)]), aes(x=cos, y=cosApprox)) + geom_density2d()
plot(mycos[upper.tri(mycos)], mycosApprox[upper.tri(mycos)])
pwd
getwd()
list.files()
file.edit("cosineVariance.R")
file.edit("cosineDistCentered.R")
dims
ndim
file.edit("cosineDistGeneral.R")
list.files()
